!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("THREE")):"function"==typeof define&&define.amd?define(["THREE"],e):"object"==typeof exports?exports.PanoControls=e(require("THREE")):t.PanoControls=e(t.THREE)}(window,function(o){return r={},i.m=n=[function(t,e,o){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0});function r(t,e,o){return t<e?e:o<t?o:t}var a,s=o(1),c={EventDispatcher:s.EventDispatcher,Vector3:s.Vector3,Spherical:s.Spherical,Vector2:s.Vector2,PerspectiveCamera:s.PerspectiveCamera},h=1e-6,u=Math.PI,l=(a=c.EventDispatcher,i(d,a),d.prototype.onRotateStart=function(t,e){var o=t.clientX,n=t.clientY;void 0===e&&(e=!1),this.state|=this.STATES.ROTATE,this.rotateStart.set(o,n),this.rotateEnd.set(o,n),e?(document.addEventListener("touchmove",this.onTouchMove),document.addEventListener("touchend",this.onTouchEnd)):(document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp))},d.prototype.onRotate=function(t){var e=t.clientX,o=t.clientY;this.rotateEnd.set(e,o),this.update(),this.rotateStart.set(e,o),this.dispatchEvent(this.INTERACT_EVENT)},d.prototype.onRotateEnd=function(t,e){void 0===e&&(e=!1),this.state&=~this.STATES.ROTATE,e?(document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd)):(document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp))},d.prototype.onTouchScaleStart=function(t){this.state|=this.STATES.SCALE;var e=t[0],o=e.clientX,n=e.clientY,i=t[1],r=i.clientX,a=i.clientY;this.touchScaleStart=new c.Vector2(o,n).distanceTo(new c.Vector2(r,a))/this.domSizeVectors.x,this.touchScaleEnd=this.touchScaleStart,document.addEventListener("touchmove",this.onTouchMove),document.addEventListener("touchend",this.onTouchEnd)},d.prototype.onTouchScale=function(t){var e=t[0],o=e.clientX,n=e.clientY,i=t[1],r=i.clientX,a=i.clientY;this.touchScaleEnd=new c.Vector2(o,n).distanceTo(new c.Vector2(r,a))/this.domSizeVectors.x,this.update(),this.touchScaleStart=this.touchScaleEnd,this.dispatchEvent(this.INTERACT_EVENT)},d.prototype.onTouchScaleEnd=function(t){this.state&=~this.STATES.SCALE,this.touchScaleStart=0,this.touchScaleEnd=0,document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd)},d.prototype.onMouseScale=function(t){Math.abs(t)<10&&(t*=40),this.state|=this.STATES.SCALE,this.touchScaleStart=0,this.touchScaleEnd=-t/7e3,this.update(),this.state&=~this.STATES.SCALE,this.dispatchEvent(this.INTERACT_EVENT)},d.prototype.addEvents=function(){this.domElement.addEventListener("mousedown",this.onMouseDown),this.domElement.addEventListener("touchstart",this.onTouchStart),this.domElement.addEventListener("wheel",this.onWheel),window.addEventListener("resize",this.onResize)},d.prototype.removeEvents=function(){this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("touchstart",this.onTouchStart),this.domElement.removeEventListener("wheel",this.onWheel),window.removeEventListener("resize",this.onResize),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)},d.prototype.update=function(){if(this.enabled){var t=this.enableRotate&&this.updateRotateDelta(),e=this.enableScale&&this.updateScaleDelta();(t||e)&&this.updateCamera()}},d.prototype.updateCamera=function(){var t=this.target,e=this.spherical,o=this.camera;this.dispatchEvent(this.CHANGE_EVENT),t.setFromSpherical(e).add(o.position),o.lookAt(t),o.updateProjectionMatrix()},d.prototype.updateRotateDelta=function(){var t=!1;return this.state&this.STATES.ROTATE?(this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).divide(this.domSizeVectors).multiplyScalar(this.rotateSpeed),this.h+=this.rotateDelta.x,this.v-=this.rotateDelta.y,t=!0):this.enableRotateDamping&&this.rotateDelta.lengthSq()>h?(this.rotateDelta.multiplyScalar(this.rotateSmoothFactor),this.h+=this.rotateDelta.x,this.v-=this.rotateDelta.y,t=!0):this.rotateDelta.set(0,0),t},d.prototype.updateScaleDelta=function(){var t=!1;return this.state&this.STATES.SCALE?(this.scaleDelta=(this.touchScaleEnd-this.touchScaleStart)*this.scaleSpeed,this.fov+=this.scaleDelta,t=!0):this.enableScaleDamping&&Math.abs(this.scaleDelta)>h?(this.scaleDelta*=this.scaleSmoothFactor,this.fov+=this.scaleDelta,t=!0):this.scaleDelta=0,t},Object.defineProperty(d.prototype,"h",{get:function(){return 180*this.spherical.theta/u},set:function(t){t=function(t,e,o){return t<e?t+o-e:o<t?t+e-o:t}(t,this.minH,this.maxH),this.spherical.theta=t/180*u,this.dispatchEvent(this.ROTATE_EVENT)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"v",{get:function(){return 180*this.spherical.phi/u},set:function(t){t=r(t,this.minV,this.maxV),this.spherical.phi=t/180*u,this.dispatchEvent(this.ROTATE_EVENT)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"fov",{get:function(){return this.camera.fov},set:function(t){t=r(t,this.minFov,this.maxFov),this.camera.fov=t,this.dispatchEvent(this.SCALE_EVENT)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"minFov",{get:function(){return this._minFov},set:function(t){t=r(t,h,180-h),this._minFov=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"maxFov",{get:function(){return this._maxFov},set:function(t){t=r(t,h,180-h),this._maxFov=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"minV",{get:function(){return this._minV},set:function(t){t=r(t,h,180-h),this._minV=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"maxV",{get:function(){return this._maxV},set:function(t){t=r(t,h,180-h),this._maxV=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"minH",{get:function(){return this._minH},set:function(t){t=r(t,-180,180),this._minH=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"maxH",{get:function(){return this._maxH},set:function(t){t=r(t,-180,180),this._maxH=t},enumerable:!0,configurable:!0}),d);function d(t,e){var r=a.call(this)||this;r.enabled=!0,r.enableRotate=!0,r.enableRotateDamping=!0,r.enableScale=!0,r.enableScaleDamping=!0,r.rotateSpeed=120,r.scaleSpeed=-100,r.rotateSmoothFactor=.9,r.scaleSmoothFactor=.9,r.STATES={NONE:0,ROTATE:1,SCALE:2},r.state=r.STATES.NONE,r.ROTATE_EVENT={type:"rotate"},r.SCALE_EVENT={type:"scale"},r.CHANGE_EVENT={type:"change"},r.INTERACT_EVENT={type:"interact"},r._minFov=40,r._maxFov=140,r._minV=h,r._maxV=180-h,r._minH=-180,r._maxH=180,r.target=new c.Vector3,r.spherical=new c.Spherical,r.touchScaleStart=0,r.scaleDelta=0,r.touchScaleEnd=0,r.rotateStart=new c.Vector2,r.rotateDelta=new c.Vector2,r.rotateEnd=new c.Vector2,r.setCursor=function(t){r.domElement.style.cursor=t},r.onResize=function(){var t=(screen.msOrientation||screen.mozOrientation||screen.orientation||{angle:0}).angle,e=45<t&&t<135||225<t&&t<315,o=window.screen,n=o.width,i=o.height;e?r.domSizeVectors.set(n,n):r.domSizeVectors.set(i,i)},r.onTouchStart=function(t){t.preventDefault();var e=t.touches;switch(e.length){case 1:r.onRotateStart(e[0],!0);break;case 2:r.onTouchScaleStart(e)}},r.onTouchMove=function(t){t.preventDefault();var e=t.touches;switch(e.length){case 1:r.onRotate(e[0]);break;case 2:r.onTouchScale(e)}},r.onTouchEnd=function(t){switch(t.preventDefault(),t.touches.length+t.changedTouches.length){case 1:r.onRotateEnd(t,!0);break;case 2:r.onTouchScaleEnd(t)}},r.onMouseDown=function(t){r.setCursor("grabbing"),t.preventDefault(),r.onRotateStart(t)},r.onMouseMove=function(t){t.preventDefault(),r.onRotate(t)},r.onMouseUp=function(t){r.setCursor("grab"),t.preventDefault(),r.onRotateEnd(t)},r.onWheel=function(t){t.preventDefault(),r.onMouseScale(t.deltaY)},r.camera=t,r.domElement=e,r.setCursor("grab");var o=t.getWorldDirection(new c.Vector3);r.spherical.setFromVector3(o),r.target.copy(t.position).add(o);e.clientWidth;var n=e.clientHeight;return r.domSizeVectors=new c.Vector2(n,n),r.onResize(),r.addEvents(),r}e.default=l},function(t,e){t.exports=o}],i.c=r,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0);function i(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}var n,r});