!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("THREE")):"function"==typeof define&&define.amd?define(["THREE"],e):"object"==typeof exports?exports.PanoControls=e(require("THREE")):t.PanoControls=e(t.THREE)}(window,function(o){return a={},i.m=n=[function(t,e,o){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0});function a(t,e,o){return t<e?e:o<t?o:t}var r,s=o(1),c={EventDispatcher:s.EventDispatcher,Vector3:s.Vector3,Spherical:s.Spherical,Vector2:s.Vector2,PerspectiveCamera:s.PerspectiveCamera},h=1e-6,u=Math.PI,l=(r=c.EventDispatcher,i(d,r),d.prototype.onRotateStart=function(t,e){var o=t.clientX,n=t.clientY;void 0===e&&(e=!1),this.state|=this.STATES.ROTATE,this.rotateStart.set(o,n),this.rotateEnd.set(o,n),e?(document.addEventListener("touchmove",this.onTouchMove),document.addEventListener("touchend",this.onTouchEnd)):(document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp))},d.prototype.onRotate=function(t){var e=t.clientX,o=t.clientY;this.rotateEnd.set(e,o),this.update(),this.rotateStart.set(e,o),this.dispatchEvent(this.INTERACT_EVENT),this.enableAutoRotate&&(this._autoRotateStart=(new Date).getTime())},d.prototype.onRotateEnd=function(t,e){void 0===e&&(e=!1),this.state&=~this.STATES.ROTATE,e?(document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd)):(document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp))},d.prototype.onTouchScaleStart=function(t){this.state|=this.STATES.SCALE;var e=t[0],o=e.clientX,n=e.clientY,i=t[1],a=i.clientX,r=i.clientY;this.touchScaleStart=new c.Vector2(o,n).distanceTo(new c.Vector2(a,r))/this.domSizeVectors.x,this.touchScaleEnd=this.touchScaleStart,document.addEventListener("touchmove",this.onTouchMove),document.addEventListener("touchend",this.onTouchEnd)},d.prototype.onTouchScale=function(t){var e=t[0],o=e.clientX,n=e.clientY,i=t[1],a=i.clientX,r=i.clientY;this.touchScaleEnd=new c.Vector2(o,n).distanceTo(new c.Vector2(a,r))/this.domSizeVectors.x,this.update(),this.touchScaleStart=this.touchScaleEnd,this.dispatchEvent(this.INTERACT_EVENT),this.enableAutoRotate&&(this._autoRotateStart=(new Date).getTime())},d.prototype.onTouchScaleEnd=function(t){this.state&=~this.STATES.SCALE,this.touchScaleStart=0,this.touchScaleEnd=0,document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd)},d.prototype.onMouseScale=function(t){Math.abs(t)<10&&(t*=40),this.state|=this.STATES.SCALE,this.touchScaleStart=0,this.touchScaleEnd=-t/7e3,this.update(),this.state&=~this.STATES.SCALE,this.dispatchEvent(this.INTERACT_EVENT),this.enableAutoRotate&&(this._autoRotateStart=(new Date).getTime())},d.prototype.addEvents=function(){this.domElement.addEventListener("mousedown",this.onMouseDown),this.domElement.addEventListener("touchstart",this.onTouchStart),this.domElement.addEventListener("wheel",this.onWheel),window.addEventListener("resize",this.onResize)},d.prototype.removeEvents=function(){this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("touchstart",this.onTouchStart),this.domElement.removeEventListener("wheel",this.onWheel),window.removeEventListener("resize",this.onResize),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)},d.prototype.update=function(){if(this.enabled){var t=this.enableRotate&&this.updateRotateDelta(),e=this.enableScale&&this.updateScaleDelta();(t||e)&&this.updateCamera()}},d.prototype.updateCamera=function(){var t=this.target,e=this.spherical,o=this.camera;this.dispatchEvent(this.CHANGE_EVENT),t.setFromSpherical(e).add(o.position),o.lookAt(t),o.updateProjectionMatrix()},d.prototype.updateRotateDelta=function(){var t=!1;this.state&this.STATES.ROTATE?(this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).divide(this.domSizeVectors).multiplyScalar(this.rotateSpeed),t=!0):this.enableRotateDamping&&this.rotateDelta.lengthSq()>h?(this.rotateDelta.multiplyScalar(this.rotateSmoothFactor),t=!0):this.rotateDelta.set(0,0);var e=(new Date).getTime()-this._autoRotateStart;return console.log(e),this.enableAutoRotate&&e>this.autoRotateInterval&&(this.state|=this.STATES.ROTATE,this.rotateDelta.x+=this.autoRotateSpeed,t=!0),t&&(this.h+=this.rotateDelta.x,this.v-=this.rotateDelta.y),t},d.prototype.updateScaleDelta=function(){var t=!1;return this.state&this.STATES.SCALE?(this.scaleDelta=(this.touchScaleEnd-this.touchScaleStart)*this.scaleSpeed,this.fov+=this.scaleDelta,t=!0):this.enableScaleDamping&&Math.abs(this.scaleDelta)>h?(this.scaleDelta*=this.scaleSmoothFactor,this.fov+=this.scaleDelta,t=!0):this.scaleDelta=0,t},Object.defineProperty(d.prototype,"h",{get:function(){return 180*this.spherical.theta/u},set:function(t){t=function(t,e,o){return t<e?t+o-e:o<t?t+e-o:t}(t,this.minH,this.maxH),this.spherical.theta=t/180*u,this.dispatchEvent(this.ROTATE_EVENT)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"v",{get:function(){return 180*this.spherical.phi/u},set:function(t){t=a(t,this.minV,this.maxV),this.spherical.phi=t/180*u,this.dispatchEvent(this.ROTATE_EVENT)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"fov",{get:function(){return this.camera.fov},set:function(t){t=a(t,this.minFov,this.maxFov),this.camera.fov=t,this.dispatchEvent(this.SCALE_EVENT)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"minFov",{get:function(){return this._minFov},set:function(t){t=a(t,h,180-h),this._minFov=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"maxFov",{get:function(){return this._maxFov},set:function(t){t=a(t,h,180-h),this._maxFov=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"minV",{get:function(){return this._minV},set:function(t){t=a(t,h,180-h),this._minV=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"maxV",{get:function(){return this._maxV},set:function(t){t=a(t,h,180-h),this._maxV=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"minH",{get:function(){return this._minH},set:function(t){t=a(t,-180,180),this._minH=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"maxH",{get:function(){return this._maxH},set:function(t){t=a(t,-180,180),this._maxH=t},enumerable:!0,configurable:!0}),d);function d(t,e){var a=r.call(this)||this;a.enabled=!0,a.enableRotate=!0,a.enableRotateDamping=!0,a.enableScale=!0,a.enableScaleDamping=!0,a.enableAutoRotate=!0,a.rotateSpeed=120,a.scaleSpeed=-100,a.rotateSmoothFactor=.9,a.scaleSmoothFactor=.9,a.autoRotateSpeed=-.05,a.autoRotateInterval=5e3,a.STATES={NONE:0,ROTATE:1,SCALE:2},a.state=a.STATES.NONE,a.ROTATE_EVENT={type:"rotate"},a.SCALE_EVENT={type:"scale"},a.CHANGE_EVENT={type:"change"},a.INTERACT_EVENT={type:"interact"},a._minFov=40,a._maxFov=140,a._minV=h,a._maxV=180-h,a._minH=-180,a._maxH=180,a._autoRotateStart=(new Date).getTime(),a.target=new c.Vector3,a.spherical=new c.Spherical,a.touchScaleStart=0,a.scaleDelta=0,a.touchScaleEnd=0,a.rotateStart=new c.Vector2,a.rotateDelta=new c.Vector2,a.rotateEnd=new c.Vector2,a.setCursor=function(t){a.domElement.style.cursor=t},a.onResize=function(){var t=(screen.msOrientation||screen.mozOrientation||screen.orientation||{angle:0}).angle,e=45<t&&t<135||225<t&&t<315,o=window.screen,n=o.width,i=o.height;e?a.domSizeVectors.set(n,n):a.domSizeVectors.set(i,i)},a.onTouchStart=function(t){t.preventDefault();var e=t.touches;switch(e.length){case 1:a.onRotateStart(e[0],!0);break;case 2:a.onTouchScaleStart(e)}},a.onTouchMove=function(t){t.preventDefault();var e=t.touches;switch(e.length){case 1:a.onRotate(e[0]);break;case 2:a.onTouchScale(e)}},a.onTouchEnd=function(t){switch(t.preventDefault(),t.touches.length+t.changedTouches.length){case 1:a.onRotateEnd(t,!0);break;case 2:a.onTouchScaleEnd(t)}},a.onMouseDown=function(t){a.setCursor("grabbing"),t.preventDefault(),a.onRotateStart(t)},a.onMouseMove=function(t){t.preventDefault(),a.onRotate(t)},a.onMouseUp=function(t){a.setCursor("grab"),t.preventDefault(),a.onRotateEnd(t)},a.onWheel=function(t){t.preventDefault(),a.onMouseScale(t.deltaY)},a.camera=t,a.domElement=e,a.setCursor("grab");var o=t.getWorldDirection(new c.Vector3);a.spherical.setFromVector3(o),a.target.copy(t.position).add(o);e.clientWidth;var n=e.clientHeight;return a.domSizeVectors=new c.Vector2(n,n),a.onResize(),a.addEvents(),a}e.default=l},function(t,e){t.exports=o}],i.c=a,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0);function i(t){if(a[t])return a[t].exports;var e=a[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}var n,a});